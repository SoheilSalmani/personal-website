---
title: Gatsby
relatedResources:
  - https://www.gatsbyjs.com/docs
tags:
  - React
  - Gatsby
---

1. Install the Gatsby CLI using Yarn or npm.

   <Solution>

   ```sh
   npm install -g gatsby-cli
   ```

   ```sh
   yarn global add gatsby-cli
   ```

   </Solution>

2. Create a Gatsby site using the CLI, and start the development server. Set up
   a GitHub repo and build your site with Gatsby Cloud.

   <Solution>

   ```sh
   gatsby new
   gatsby develop
   ```

   </Solution>

3. Create page components, an SEO component, and a layout component styled using
   a CSS module. Also, add global styles using a CSS file.

   <Solution>

   ```sh
   npm install gatsby-plugin-react-helmet react-helmet
   ```

   ```css fp=src/styles/global.css nu
   :root {
     --black: #333;
     --gray: #555;
     --white: #eee;
   }

   html {
     box-sizing: border-box;
     background-color: var(--white);
     color: var(--gray);
     font-family: sans-serif;
     font-size: 18px;
     line-height: 1.4;
   }

   *,
   *::before,
   *::after {
     box-sizing: inherit;
   }

   body {
     margin: 0;
     padding: 2rem;
     width: 90vw;
     max-width: 800px;
     margin: 0 auto;
   }

   h1,
   h2,
   h3,
   h4,
   h5,
   h6 {
     color: var(--black);
   }
   ```

   ```js fp=gatsby-config.js nu
   module.exports = {
     siteMetadata: {
       title: `My Gatsby Site`,
       description: `A Gatsby website.`,
       siteUrl: `<site-url>`,
       image: `<image-url>`,
     },
     plugins: [`gatsby-plugin-react-helmet`],
   }
   ```

   ```jsx fp=src/components/seo.js nu
   import * as React from "react"
   import { Helmet } from "react-helmet"
   import { useStaticQuery, graphql } from "gatsby"

   export default function Seo(props) {
     const data = useStaticQuery(graphql`
       query GetSiteMetadata {
         site {
           siteMetadata {
             description
             image
             siteUrl
           }
         }
       }
     `)

     const defaults = data.site.siteMetadata
     const title = props.pageTitle
       ? `${props.pageTitle} | ${props.siteName}`
       : props.siteName
     const description = props.description || defaults.description
     const image = new URL(props.image || defaults.image, defaults.siteUrl)
     const url = new URL(props.path || "/", defaults.siteUrl)

     return (
       <Helmet>
         <title>{title}</title>
         <link rel="canonical" href={url} />
         <meta name="description" content={description} />
         <meta name="image" content={image} />
         <meta property="og:url" content={url} />
         <meta property="og:type" content="website" />
         <meta property="og:title" content={title} />
         <meta property="og:description" content={description} />
         <meta property="og:image" content={image} />
         <meta name="twitter:card" content="summary_large_image" />
         <meta name="twitter:title" content={title} />
         <meta name="twitter:description" content={description} />
         <meta name="twitter:image" content={image} />
       </Helmet>
     )
   }
   ```

   ```jsx fp=src/components/layout.js nu
   import * as React from "react"
   import { Link, useStaticQuery, graphql } from "gatsby"
   import Seo from "./seo"
   import "../styles/global.css"
   import * as styles from "./layout.module.css"

   export default function Layout({
     pageTitle,
     description,
     path,
     image,
     children,
   }) {
     const data = useStaticQuery(graphql`
       query GetSiteName {
         site {
           siteMetadata {
             title
           }
         }
       }
     `)

     const siteName = data.site.siteMetadata.title

     return (
       <>
         <Seo
           siteName={siteName}
           pageTitle={pageTitle}
           description={description}
           path={path}
           image={image}
         />
         <nav>
           <ul className={styles.navLinkList}>
             <li className={styles.siteNameLink}>
               <strong>
                 <Link to="/">{siteName}</Link>
               </strong>
             </li>
             <li>
               <Link to="/">Home</Link>
             </li>
             <li>
               <Link to="/about">About</Link>
             </li>
             <li>
               <Link to="/blog">Blog</Link>
             </li>
           </ul>
         </nav>
         <main>
           <h1>{pageTitle}</h1>
           {children}
         </main>
       </>
     )
   }
   ```

   ```css fp=src/components/layout.module.css nu
   .nav-link-list {
     list-style-type: none;
     padding: 0;
     margin: 0;
     display: flex;
     justify-content: center;
     align-items: center;
     gap: 2rem;
   }

   .site-name-link {
     margin-right: auto;
   }
   ```

   ```jsx fp=src/pages/index.js nu
   import * as React from "react"
   import Layout from "../components/layout"

   export default function IndexPage({ location }) {
     return (
       <Layout pageTitle="Home" path={location.pathname}>
         <p>I'm making this by following the Gatsby Tutorial.</p>
       </Layout>
     )
   }
   ```

   ```jsx fp=src/pages/about.js nu
   import * as React from "react"
   import Layout from "../components/layout"

   export default function AboutPage({ location }) {
     return (
       <Layout pageTitle="About Me" path={location.pathname}>
         <p>
           Hi there! I'm the proud creator of this site, which I built with
           Gatsby.
         </p>
       </Layout>
     )
   }
   ```

   </Solution>

4. Add a plugin to add responsive images to your site while maintaining high
   performance scores. Test the plugin with a image from your local filesystem,
   and with an image from an external URL.

   <Solution>

   ```sh
   npm install gatsby-plugin-image gatsby-plugin-sharp gatsby-source-filesystem
   ```

   ```js fp=gatsby-config.js nu
   module.exports = {
     siteMetadata: {
       title: "My First Gatsby Site",
     },
     plugins: ["gatsby-plugin-image", "gatsby-plugin-sharp"],
   }
   ```

   ```jsx fp=src/pages/index.js nu hl=3,9..12
   import * as React from "react"
   import Layout from "../components/layout"
   import { StaticImage } from "gatsby-plugin-image"

   export default function IndexPage({ location }) {
     return (
       <Layout pageTitle="Home" path={location.pathname}>
         <p>I'm making this by following the Gatsby Tutorial.</p>
         <StaticImage
           alt="The mountains of Chamonix."
           src="https://en.chamonix.com/sites/default/files/styles/ogimage/public/media/images/%C2%A9Fabian_Bodet.jpg"
         />
       </Layout>
     )
   }
   ```

   </Solution>

5. Create a "Blog" page with data loaded from a page query.

   <Solution>

   ```sh
   mkdir blog
   cd blog
   touch my-first-post.mdx
   touch another-post.mdx
   ```

   ```js fp=gatsby-config.js hl=6..12
   module.exports = {
     ...
     plugins: [
       "gatsby-plugin-image",
       "gatsby-plugin-sharp",
       {
         resolve: "gatsby-source-filesystem",
         options: {
           name: `blog`,
           path: `${__dirname}/blog`,
         }
       },
     ],
   }
   ```

   ```jsx fp=src/pages/blog.js nu
   import * as React from "react"
   import { graphql } from "gatsby"
   import Layout from "../components/layout"

   export const query = graphql`
     query GetPosts {
       allFile(filter: { sourceInstanceName: { eq: "blog" } }) {
         nodes {
           id
           name
         }
       }
     }
   `

   export default function BlogPage({ data, location }) {
     const posts = data.allFile.nodes
     return (
       <Layout pageTitle="Blog" path={location.pathname}>
         <ul>
           {posts.map(post => (
             <li key={post.id}>{post.name}</li>
           ))}
         </ul>
       </Layout>
     )
   }
   ```

   </Solution>

6. Complete the MDX content and load them in the website.

   <Solution>

   ```sh
   npm install gatsby-plugin-mdx @mdx-js/mdx @mdx-js/react
   ```

   ```mdx fp=blog/another-post.mdx nu
   ---
   title: Another Post
   date: 2022-01-01
   ---

   Hello, world!
   ```

   ```mdx fp=blog/my-first-post.mdx nu
   ---
   title: My First Post
   date: 2021-12-20
   ---

   Hello, world!
   ```

   ```js fp=gatsby-config.js hl=5
   module.exports = {
     ...
     plugins: [
       ...
       "gatsby-plugin-mdx",
     ],
   };
   ```

   ```jsx fp=src/pages/blog.js hl=2,7..16,21,26..30
   ...
   import { MDXRenderer } from "gatsby-plugin-mdx"
   ...

   export const query = graphql`
     query GetPosts {
       allMdx(sort: { order: DESC, fields: frontmatter___date }) {
         nodes {
           id
           body
           frontmatter {
             title
             date(formatString: "MMMM D, YYYY")
           }
         }
       }
     }
   `

   export default function BlogPage({ data, location }) {
     const posts = data.allMdx.nodes
     return (
       <Layout pageTitle="Blog" path={location.pathname}>
         <ul>
           {posts.map(post => (
             <article key={post.id}>
               <h2>{post.frontmatter.title}</h2>
               <p>Posted: {post.frontmatter.date}</p>
               <MDXRenderer>{post.body}</MDXRenderer>
             </article>
           ))}
         </ul>
       </Layout>
     )
   }
   ```

   </Solution>

7. Create a page programatically for each blog post.

   <Solution>

   ```jsx fp=src/pages/blog/index.js nu hl=2..3,10,23..31
   import * as React from "react"
   import { graphql, Link } from "gatsby"
   import Layout from "../../components/layout"

   export const query = graphql`
     query GetPosts {
       allMdx(sort: { order: DESC, fields: frontmatter___date }) {
         nodes {
           id
           slug
           frontmatter {
             title
             date(formatString: "MMMM D, YYYY")
           }
         }
       }
     }
   `
   export default function BlogPage({ data, location }) {
     const posts = data.allMdx.nodes
     return (
       <Layout pageTitle="Blog" path={location.pathname}>
         <ul>
           {posts.map(post => (
             <li key={post.id}>
               <Link to={`/blog/${post.slug}`}>
                 {post.frontmatter.title} ({post.frontmatter.date})
               </Link>
             </li>
           ))}
         </ul>
       </Layout>
     )
   }
   ```

   ```jsx fp=src/pages/blog/{mdx.slug}.js nu
   import * as React from "react"
   import { graphql } from "gatsby"
   import { MDXRenderer } from "gatsby-plugin-mdx"
   import Layout from "../../components/layout"

   export const query = graphql`
     query GetPost($id: String) {
       mdx(id: { eq: $id }) {
         body
         frontmatter {
           title
           date(formatString: "MMMM D, YYYY")
         }
       }
     }
   `

   export default function BlogPost({ data, location }) {
     const post = data.mdx
     return (
       <Layout pageTitle={post.frontmatter.title} path={location.pathname}>
         <p>Posted: {post.frontmatter.date}</p>
         <MDXRenderer>{post.body}</MDXRenderer>
       </Layout>
     )
   }
   ```

   </Solution>

8. Add a hero image for each blog post.

   <Solution>

   ```sh
   npm install gatsby-transformer-sharp
   ```

   ```js fp=gatsby-config.js hl=5
   module.exports = {
     ...
     plugins: [
       ...
       "gatsby-transformer-sharp",
     ],
   };
   ```

   ```mdx fp=blog/my-first-post/index.mdx hl=4..5
   ---
   title: My First Post
   date: 2020-12-01
   hero_image: ./hero.jpg
   hero_image_alt: The mountains of Chamonix.
   ---

   Hello, world!
   ```

   ```mdx fp=blog/another-post/index.mdx hl=4..5
   ---
   title: Another Post
   date: 2021-01-01
   hero_image: ./hero.jpg
   hero_image_alt: The mountains of Chamonix.
   ---

   Hello, world!
   ```

   ```jsx fp=src/pages/blog/{mdx.slug}.js nu hl=4,14..19,30..35
   import * as React from "react"
   import { graphql } from "gatsby"
   import { MDXRenderer } from "gatsby-plugin-mdx"
   import { GatsbyImage, getImage } from "gatsby-plugin-image"
   import Layout from "../../components/layout"

   export const query = graphql`
     query GetPost($id: String) {
       mdx(id: { eq: $id }) {
         body
         frontmatter {
           title
           date(formatString: "MMMM D, YYYY")
           hero_image_alt
           hero_image {
             childImageSharp {
               gatsbyImageData
             }
           }
         }
       }
     }
   `

   export default function BlogPage({ data, location }) {
     const post = data.mdx
     return (
       <Layout pageTitle={post.frontmatter.title} path={location.pathname}>
         <p>Posted: {post.frontmatter.date}</p>
         <p>
           <GatsbyImage
             image={getImage(post.frontmatter.hero_image)}
             alt={post.frontmatter.hero_image_alt}
           />
         </p>
         <MDXRenderer>{post.body}</MDXRenderer>
       </Layout>
     )
   }
   ```

   </Solution>
