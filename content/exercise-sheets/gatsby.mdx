---
title: Gatsby
relatedResources:
  - https://www.gatsbyjs.com/docs
tags:
  - React
  - Gatsby
---

1. Install the Gatsby CLI using Yarn or npm.

   <Solution>

   ```sh
   npm install -g gatsby-cli
   ```

   ```sh
   yarn global add gatsby-cli
   ```

   </Solution>

2. Create a Gatsby site using the CLI, and start the development server. Set up a GitHub repo and build your site with Gatsby Cloud.

   <Solution>

   ```sh
   gatsby new
   gatsby develop
   ```

   </Solution>

3. Create to page components and a layout component styled using a CSS module.

   <Solution>

   ```jsx fp=src/pages/index.js nu
   import * as React from "react"
   import Layout from "../components/layout"

   const IndexPage = () => {
     return (
       <Layout pageTitle="Home Page">
         <p>I'm making this by following the Gatsby Tutorial.</p>
       </Layout>
     )
   }

   export default IndexPage
   ```

   ```jsx fp=src/pages/about.js nu
   import * as React from "react"
   import Layout from "../components/layout"

   const AboutPage = () => {
     return (
       <Layout pageTitle="About Me">
         <p>
           Hi there! I'm the proud creator of this site, which I built with
           Gatsby.
         </p>
       </Layout>
     )
   }

   export default AboutPage
   ```

   ```jsx fp=src/components/layout.js nu
   import * as React from "react"
   import { Link } from "gatsby"
   import {
     container,
     heading,
     navLinks,
     navLinkItem,
     navLinkText,
   } from "./layout.module.css"

   const Layout = ({ pageTitle, children }) => {
     return (
       <div className={container}>
         <title>{pageTitle}</title>
         <nav>
           <ul className={navLinks}>
             <li className={navLinkItem}>
               <Link to="/" className={navLinkText}>
                 Home
               </Link>
             </li>
             <li className={navLinkItem}>
               <Link to="/about" className={navLinkText}>
                 About
               </Link>
             </li>
           </ul>
         </nav>
         <main>
           <h1 className={heading}>{pageTitle}</h1>
           {children}
         </main>
       </div>
     )
   }

   export default Layout
   ```

   ```css fp=src/components/layout.module.css nu
   .container {
     margin: auto;
     max-width: 500px;
     font-family: sans-serif;
   }

   .heading {
     color: rebeccapurple;
   }

   .nav-links {
     display: flex;
     list-style: none;
     padding-left: 0;
   }

   .nav-link-item {
     padding-right: 2rem;
   }

   .nav-link-text {
     color: black;
   }
   ```

   </Solution>

4. Add a plugin to add responsive images to your site while maintaining high performance scores. Test the plugin with a iamge from your local filesystem, and with an image from an external URL.

   <Solution>

   ```sh
   npm install gatsby-plugin-image gatsby-plugin-sharp gatsby-source-filesystem
   ```

   ```js fp=gatsby-config.js nu
   module.exports = {
     siteMetadata: {
       title: "My First Gatsby Site",
     },
     plugins: ["gatsby-plugin-image", "gatsby-plugin-sharp"],
   }
   ```

   ```jsx fp=src/pages/index.js nu hl=3,9..12
   import * as React from "react"
   import Layout from "../components/layout"
   import { StaticImage } from "gatsby-plugin-image"

   const IndexPage = () => {
     return (
       <Layout pageTitle="Home Page">
         <p>I'm making this by following the Gatsby Tutorial.</p>
         <StaticImage
           alt="Clifford, a reddish-brown pitbull, posing on a couch and looking stoically at the camera"
           src="https://pbs.twimg.com/media/E1oMV3QVgAIr1NT?format=jpg&name=large"
         />
       </Layout>
     )
   }

   export default IndexPage
   ```

   </Solution>

5. Load the site title using GraphQL, and create a "Blog" page with data loaded from a page query.

   <Solution>

   ```sh
   mkdir blog
   cd blog
   touch my-first-post.mdx
   touch another-post.mdx
   touch yet-another-post.mdx
   ```

   ```js fp=gatsby-config.js hl=6..12
   module.exports = {
     ...
     plugins: [
       "gatsby-plugin-image",
       "gatsby-plugin-sharp",
       {
         resolve: "gatsby-source-filesystem",
         options: {
           name: `blog`,
           path: `${__dirname}/blog`,
         }
       },
     ],
   }
   ```

   ```jsx fp=src/components/layout.js hl=2,5,9..17,21..22,28..32
   import * as React from "react"
   import { Link, useStaticQuery, graphql } from 'gatsby'
   import {
     ...
     siteTitle,
   } from "./layout.module.css"

   const Layout = ({ pageTitle, children }) => {
     const data = useStaticQuery(graphql`
       query {
         site {
           siteMetadata {
             title
           }
         }
       }
     `)

     return (
       <div className={container}>
         <title>{pageTitle} | {data.site.siteMetadata.title}</title>
         <header className={siteTitle}>{data.site.siteMetadata.title}</header>
         <nav>
           <ul className={navLinks}>
             <li className={navLinkItem}>
               ...
             </li>
             <li className={navLinkItem}>
               <Link to="/blog" className={navLinkText}>
                 Blog
               </Link>
             </li>
           </ul>
         </nav>
         ...
       </div>
     )
   }

   export default Layout
   ```

   ```css fp=src/components/layout.module.css
   ... .site-title {
     font-size: 3rem;
     color: gray;
     font-weight: 700;
     margin: 3rem 0;
   }
   ```

   ```jsx fp=src/pages/blog.js nu
   import * as React from "react"
   import { graphql } from "gatsby"
   import Layout from "../components/layout"

   const BlogPage = ({ data }) => {
     return (
       <Layout pageTitle="My Blog Posts">
         <ul>
           {data.allFile.nodes.map(node => (
             <li key={node.name}>{node.name}</li>
           ))}
         </ul>
       </Layout>
     )
   }

   export const query = graphql`
     query {
       allFile(filter: { sourceInstanceName: { eq: "blog" } }) {
         nodes {
           name
         }
       }
     }
   `

   export default BlogPage
   ```

   </Solution>

6. Complete the MDX content and load them in the website.

<Solution>

```sh
npm install gatsby-plugin-mdx @mdx-js/mdx @mdx-js/react
```

```mdx fp=blog/another-post.mdx nu
---
title: "Another Post"
date: "2021-07-24"
---

Here's another post! It's even better than the first one!
```

```mdx fp=blog/my-first-post.mdx nu
---
title: "My First Post"
date: "2021-07-23"
---

This is my first blog post! Isn't it _great_?

Some of my **favorite** things are:

- Petting dogs
- Singing
- Eating potato-based foods
```

```mdx fp=blog/yet-another-post.mdx nu
---
title: "Yet Another Post"
date: "2021-07-25"
---

Wow look at all this content. How do they do it?
```

```js fp=gatsby-config.js hl=5
module.exports = {
  ...
  plugins: [
    ...
    "gatsby-plugin-mdx",
  ],
};
```

```jsx fp=src/pages/blog.js hl=2,9..17,25..34, nu
...
import { MDXRenderer } from 'gatsby-plugin-mdx'
...

const BlogPage = ({ data }) => {
  return (
    <Layout pageTitle="My Blog Posts">
      {
        data.allMdx.nodes.map((node) => (
          <article key={node.id}>
            <h2>{node.frontmatter.title}</h2>
            <p>Posted: {node.frontmatter.date}</p>
            <MDXRenderer>
              {node.body}
            </MDXRenderer>
          </article>
        ))
      }
    </Layout>
  )
}

export const query = graphql`
  query {
    allMdx(sort: {fields: frontmatter___date, order: DESC}) {
      nodes {
        frontmatter {
          date(formatString: "MMMM D, YYYY")
          title
        }
        id
        body
      }
    }
  }
`

export default BlogPage
```

</Solution>
